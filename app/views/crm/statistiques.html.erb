<h1>Statistiques</h1>
<div class="flex">
  <div class="stat_bloc">
    <h2>Commandes en cours</h2>
    <p>Total HT : <%= @orders.where(state:"En attente de paiement").sum(:amount_ht_cents)/100%> <%= currency_symbol %></p>
    <p>Nombre de commandes : <%= @orders.where(state:"En attente de paiement").count %></p>
  </div>

  <div class="stat_bloc">
    <h2>CA généré 2024</h2>
    <p>Total HT : <%= @orders.where(state:"Payée").sum(:amount_ht_cents)/100%> <%= currency_symbol %></p>
    <p>Nombre de commandes : <%= @orders.where(state:"Payée").count %></p>
  </div>
  <div class="stat_bloc">
    <h2>Nombre de clients</h2>
    <p>Nouveaux clients 2024 :</p>
    <p>Total clients :</p>
  </div>
  <div class="stat_bloc">
    <h2>Prospects</h2>
    <p>Nouveaux prospects :</p>
    <p>En cours de traitement :</p>
    <p title="Nombre de prospects assignés et traîtés au cours de l'année">Total prospects traités 2024 :</p>
  </div>

</div>
<div class="flex">
  <div class="stat_bloc">
    <h2>Clients n'ayant pas commandé :</h2>
    <p>Depuis 6 mois :</p>
    <p>Depuis 9 mois :</p>
    <p>Depuis 12 mois et plus :</p>
  </div>
</div>

<h3>Nombre de prospects</h3>
<%= column_chart @prospects.group_by_day(:date_prospect).count %>
<%= line_chart [
{name: "Nouveau", data: @prospects.map{|t| [t.date_prospect,t.statut] }},
{name: "En cours de traitement", data: @en_cours.map{|t| [t.date_prospect,t.statut] } },
{name: "Clients", data: @clients.map{|t| [t.date_prospect,t.statut] }}] %>

<%= line_chart [
{name: "Math", data: 3000},
{name: "Writing", data: 1000},
{name: "Reading", data: 5000}] %>


<%= column_chart [["2021-01-01", [10]],["2021-01-01", [23]], ["2021-01-02", 6]], stacked: true,colors: ["#b00", "#666"] %>
<% data = [
  {
    name: "Fantasy & Sci Fi",
    data: [["2010", 10], ["2020", 16], ["2030", 28]]
  },
  {
    name: "Romance",
    data: [["2010", 24], ["2020", 22], ["2030", 19]]
  },
  {
    name: "Mystery/Crime",
    data: [["2010", 20], ["2020", 23], ["2030", 29]]
  }
]%>
<%= column_chart data, stacked:true%>
<% sample = [
  {
    name:"ca devisé",
    data:[["janvier",40],["fevrier",60],["mars",80]]
  },
  { name:"ca réalisé",
  data:[["janvier",10],["fevrier",20],["mars",30]]
  },
  {
    name:"ca 2023",
    data:[["janvier",10],["fevrier",20],["mars",30]]
  }
]
%>
<%= column_chart sample,colors: ["#b00", "#666"] %>

<h3>Nombre de nouveaux clients</h3>
<%= column_chart @prospects.group_by_day(:date_prospect).count %>
<h3>Nombre de clients</h3>
<%= column_chart @prospects.group_by_day(:date_prospect).count %>
<h3>Nombre de commandes passées</h3>
<%= column_chart @orders.group_by_month(:custom_date).count %>
<%= scatter_chart @orders.group_by_month(:custom_date).count %>
<h3>Volume d'affaire par client</h3>
<% sample1 = [
  {
    name:"2023",
    data:[["2023",["Camille Becht",1500]]]
  },
  {
    name:"2024",
    data:[["2024",["Camille Becht",800]]]
  }
]
%>
<% sample2 = [[size: "10km",
    population:"10 000"],
  [size: "20km",
    population:"20 000"
  ]
]%>


<%= scatter_chart [
  {name: "2023", data: {"2023-01-01" => 3000, "2021-04-02" => 4000}},
  {name: "2024", data: {"2024-01-01" => 5000, "2024-03-02" => 3000}}
] %>
<hr>

<h3>CA généré 2024</h3>
<%= column_chart @prospects.group_by_day(:date_prospect).count %>
<h3>Status des prospects</h3>
<%= column_chart @prospects.group(:statut).count %>
